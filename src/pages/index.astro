---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import About from "../components/About.astro";
import DetailedAbout from "../components/DetailedAbout.astro";
import Timeline from "../components/Timeline.astro";
import SimpleCard from "../components/SimpleCard.astro";
// Mocks and requests
import { expMock } from "../data/Exp";
import { Projects } from "../data/Projects";
---

<Layout title="Christopher Sae Glood | Desarrollador Fullstack">
  <header>
    <nav
      class="px-6 md:px-12 lg:px-20 w-full text-gray-50 z-50 transition-all duration-300 ease-in-out"
    >
      <Navbar />
    </nav>
  </header>

  <main
    class="flex flex-col gap-20 py-10 px-6 md:px-12 md:py-16 lg:px-20 lg:max-w-6xl lg:mx-auto"
  >
    <!-- Sección Sobre Mí -->
    <div id="hero" class="reveal">
      <About />
    </div>

    <!-- Sección Experiencia Laboral -->
    <section class="relative flex flex-col gap-10">
      <h2 class="text-center text-light font-bold text-3xl reveal">
        Experiencia Laboral
      </h2>

      <div
        class="hidden md:block absolute top-1/2 left-0 right-0 h-1 bg-linear-to-r from-primary/20 via-primary to-primary/20 transform -translate-y-1/2"
      >
      </div>

      <div class="flex flex-wrap justify-around gap-12 md:gap-6">
        {
          expMock.map((exp, index) => (
            <Timeline
              key={exp.id}
              date={exp.date}
              title={exp.title}
              description={exp.description}
              url={exp.url}
              details={exp.details}
              isFirst={index === 0}
              isLast={index === expMock.length - 1}
              isTop={index % 2 === 0}
            />
          ))
        }
      </div>
    </section>

    <!-- Sección Proyectos -->
    <section id="projects" class="flex flex-col gap-10">
      <h2 class="text-center text-light font-bold text-3xl reveal">
        Proyectos
      </h2>
      {
        Projects.map((project, index) => (
          <SimpleCard
            index={index}
            key={project.id}
            title={project.title}
            description={project.description}
            img_url={project.img_url}
            project_url={project.project_url}
            tags={project.tags}
          />
        ))
      }
    </section>

    <section id="detailedaboutme" class="flex flex-col gap-10 reveal">
      <h2 class="text-center text-light font-bold text-3xl">Más Sobre Mí</h2>
      <DetailedAbout />
    </section>
  </main>
  <Footer />
</Layout>

<script>
  import { inView, animate } from "motion";

  // Configuramos la animación para cada elemento con la clase .reveal
  inView(
    ".reveal",
    (element) => {
      animate(
        element,
        {
          opacity: [0, 1],
          y: [20, 0], // Pequeño desplazamiento hacia arriba para un efecto más fluido
          filter: ["blur(4px)", "blur(0px)"], // Opcional: desenfoque inicial
        },
        {
          duration: 0.6,
          ease: [0.17, 0.55, 0.55, 1], // Easing suave
        },
      );

      // Al no retornar una función de limpieza, inView se ejecuta solo la primera vez que entra
    },
    { amount: "some" },
  ); // "some" asegura que se dispare en cuanto toque 1px del viewport
</script>

<style>
  /* Prevenimos que los elementos parpadeen antes de que cargue el JS */
  .reveal {
    opacity: 0;
  }

  /* Si el usuario tiene desactivado JS o prefiere movimiento reducido, mostramos todo */
  @media (prefers-reduced-motion: reduce) {
    .reveal {
      opacity: 1 !important;
    }
  }
</style>
